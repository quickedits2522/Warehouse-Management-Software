<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings - {{ company_name }}</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #b6c7d6 0%, #95e0ea 100%);
      margin: 0;
      min-height: 100vh;
      color: #1e293b;
      opacity: 0;
      animation: fadeIn 0.7s ease-in forwards;
    }

    header {
      position: sticky;
      top: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 40px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      z-index: 1000;
    }

    header img {
      height: 50px;
      margin-right: 15px;
      object-fit: contain;
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    header h1 {
      font-weight: 700;
      font-size: 1.7rem;
      color: #1e3a8a;
      margin: 0;
    }

    .back-btn {
      text-decoration: none;
      color: white;
      background: #2563eb;
      padding: 10px 22px;
      border-radius: 8px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(37,99,235,0.3);
      transition: all 0.3s ease;
    }

    .back-btn:hover {
      background: #1d4ed8;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(37,99,235,0.35);
    }

    .container {
      max-width: 750px;
      margin: 70px auto 50px auto;
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      border-radius: 20px;
      padding: 40px 50px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.1);
      animation: slideUp 0.8s ease-in-out;
    }

    h2 {
      text-align: center;
      color: #1e3a8a;
      font-weight: 700;
      margin-bottom: 35px;
      letter-spacing: 0.5px;
    }

    .setting {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(209,213,219,0.5);
      padding: 14px 0;
    }

    .setting:last-child {
      border-bottom: none;
    }

    .label {
      flex: 1;
      font-weight: 600;
      color: #334155;
      font-size: 1rem;
    }

    .value {
      flex: 1.2;
      text-align: right;
    }

    .value input,
    .value select {
      width: 100%;
      max-width: 300px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      font-size: 0.95rem;
      transition: 0.2s ease;
      box-sizing: border-box;
    }

    .value input:focus,
    .value select:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 6px rgba(37,99,235,0.3);
    }

    .value select {
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%231e3a8a" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
      background-color: white;
    }

    .save-btn {
      display: block;
      margin: 35px auto 0 auto;
      background: linear-gradient(90deg, #2563eb, #3b82f6);
      color: white;
      padding: 12px 28px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 6px 15px rgba(37,99,235,0.3);
    }

    .save-btn:hover {
      background: linear-gradient(90deg, #1d4ed8, #2563eb);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(37,99,235,0.35);
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        padding: 15px 20px;
      }
      .container {
        margin: 100px 20px 40px 20px;
        padding: 25px;
      }
      .setting {
        flex-direction: column;
        align-items: flex-start;
      }
      .value {
        width: 100%;
        text-align: left;
        margin-top: 6px;
      }
      .value input,
      .value select {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <header>
    <div class="header-left">
      <img src="/static/logo.png" alt="Company Logo">
      <h1>{{ company_name }}</h1>
    </div>
    <a href="/" class="back-btn">üè† Dashboard</a>
  </header>

  <div class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="container mt-3">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% endwith %}
    
    <h2>‚öôÔ∏è System Settings</h2>
    <form method="POST" action="/settings" autocomplete="on">
      {% for key, value in settings.items() %}
      <div class="setting">
        <div class="label">{{ key }}</div>
        <div class="value">
          {% set autocomplete_attr = "" %}
          {% if key == 'Company Name' %} {% set autocomplete_attr = "organization" %}
          {% elif key == 'Company Address' %} {% set autocomplete_attr = "street-address" %}
          {% elif key == 'Company Mobile Number' %} {% set autocomplete_attr = "tel" %}
          {% elif key == 'Company Email ID' %} {% set autocomplete_attr = "email" %}
          {% else %} {% set autocomplete_attr = "off" %} {% endif %}

          {% if key == 'State' %}
          <select name="{{ key }}" required>
            <option value="">-- Select State --</option>
            {% set states = [
              'Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh', 'Goa', 'Gujarat', 'Haryana', 
              'Himachal Pradesh', 'Jharkhand', 'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur', 
              'Meghalaya', 'Mizoram', 'Nagaland', 'Odisha', 'Punjab', 'Rajasthan', 'Sikkim', 'Tamil Nadu', 'Telangana', 
              'Tripura', 'Uttar Pradesh', 'Uttarakhand', 'West Bengal', 'Andaman and Nicobar Islands', 'Chandigarh', 
              'Dadra and Nagar Haveli and Daman and Diu', 'Delhi', 'Jammu and Kashmir', 'Ladakh', 'Lakshadweep', 'Puducherry'
            ] %}
            {% for state in states %}
              <option value="{{ state }}" {% if value == state %}selected{% endif %}>{{ state }}</option>
            {% endfor %}
          </select>

          {% elif key in ['IGST', 'CGST', 'SGST'] %}
            <input type="number" name="{{ key }}" value="{{ (value * 100) | round(2) }}" autocomplete="{{ autocomplete_attr }}" min="0" required>
          {% elif key in ['Company ID', 'Company Mobile Number'] %}
            <input type="number" name="{{ key }}" value="{{ value }}" autocomplete="{{ autocomplete_attr }}" min="0" required>
          {% else %}
            <input type="text" name="{{ key }}" value="{{ value }}" autocomplete="{{ autocomplete_attr }}" required>
          {% endif %}

        </div>
      </div>
      {% endfor %}
      <button type="submit" class="save-btn">Save Changes</button>
    </form>
  </div>

</body>
</html>
